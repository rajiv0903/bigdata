-----------------------------------------------------------------------------------------------------------
-- List Databases
-- Configuration: /etc/hive/conf
-----------------------------------------------------------------------------------------------------------
SHOW DATABASES;

-----------------------------------------------------------------------------------------------------------
-- Create Database: Datawarehouse location: /user/hive/warehouse/rc_employee_udf.db
-----------------------------------------------------------------------------------------------------------
CREATE DATABASE IF NOT EXISTS rc_employee_udf;

-----------------------------------------------------------------------------------------------------------
-- Select Database to Use
-----------------------------------------------------------------------------------------------------------
USE rc_employee_udf;

-----------------------------------------------------------------------------------------------------------
-- Create Table 
-----------------------------------------------------------------------------------------------------------
CREATE TABLE IF NOT EXISTS rc_employee_udf.employee (name STRING, salary FLOAT, city STRING)
row format delimited
fields terminated by ','
lines terminated by '\n'
stored as textfile;

-----------------------------------------------------------------------------------------------------------
-- LIST TABLES
-----------------------------------------------------------------------------------------------------------
SHOW TABLES;

-----------------------------------------------------------------------------------------------------------
-- Describe
-----------------------------------------------------------------------------------------------------------
DESCRIBE  rc_employee_udf.employee;
DESCRIBE EXTENDED rc_employee_udf.employee; 
-----------------------------------------------------------------------------------------------------------
-- Load Data
-----------------------------------------------------------------------------------------------------------
LOAD DATA LOCAL INPATH '/mnt/home/edureka_424232/hive/artifacts/emp_udf' 
OVERWRITE INTO TABLE rc_employee_udf.employee;
-----------------------------------------------------------------------------------------------------------
-- Add JAR and Create Function
-----------------------------------------------------------------------------------------------------------
ADD JAR /mnt/home/edureka_424232/hive/jars/hive-udf-practice.jar;

CREATE TEMPORARY FUNCTION rc_lower AS 'com.practice.bigdata.hadoop.hive.advance.udf.Capitalize';

-----------------------------------------------------------------------------------------------------------
-- Select
-----------------------------------------------------------------------------------------------------------
SELECT rc_lower(emp.name), salary, rc_lower(emp.city) FROM rc_employee_udf.employee emp;

----------------------------------------------------------------------------------------------------------
-- Drop table: 
----------------------------------------------------------------------------------------------------------
DROP table rc_employee_udf.employee;

----------------------------------------------------------------------------------------------------------
-- Drop Database: 
----------------------------------------------------------------------------------------------------------
DROP DATABASE rc_employee_udf;